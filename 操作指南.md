# 每日股票分析系统 · 操作指南

> 本系统基于 GitHub Actions 自动运行，分析结果通过 Telegram 推送到你的手机。

---

## 目录

1. [修改分析的股票列表](#1-修改分析的股票列表)
2. [手动触发分析](#2-手动触发分析)
3. [查看运行状态](#3-查看运行状态)
4. [接收 Telegram 推送](#4-接收-telegram-推送)
5. [定时自动运行说明](#5-定时自动运行说明)
6. [常见问题排查](#6-常见问题排查)

---

## 1. 修改分析的股票列表

股票列表通过仓库变量 `STOCK_LIST` 配置，支持 A股、港股、美股混合。

### 操作步骤

1. 打开仓库页面，点击顶部 **Settings**（设置）
2. 左侧菜单选择 **Secrets and variables** → **Actions**
3. 点击上方 **Variables** 选项卡
4. 找到 `STOCK_LIST`，点击右侧 ✏️ 编辑图标
   - 如果没有，点击 **New repository variable** 新建
5. 在 Value 输入框填入股票代码，**多个代码用英文逗号分隔**
6. 点击 **Save variable** 保存

### 股票代码格式

| 市场 | 代码格式 | 示例 |
|------|---------|------|
| A股 沪市 | 6位数字 | `600519`（贵州茅台）|
| A股 深市 | 6位数字 | `000858`（五粮液）|
| A股 创业板 | 6位数字 | `300750`（宁德时代）|
| 港股 | 5位数字 | `00700`（腾讯）`09988`（阿里）|
| 美股 | 英文字母 | `AAPL`（苹果）`TSLA`（特斯拉）|

### 示例配置

```
# 纯A股
600519,000858,300750,002594

# A股 + 港股混合
600519,300750,00700,09988,01810

# A股 + 港股 + 美股
600519,00700,AAPL,TSLA
```

> ⚠️ **注意**：股票数量建议不超过 20 只，过多会导致运行超时（GitHub Actions 限制 30 分钟）。

---

## 2. 手动触发分析

不用等定时任务，随时可以手动触发一次分析。

### 操作步骤

1. 打开仓库页面，点击顶部 **Actions** 标签
2. 左侧点击 **每日股票分析**
3. 右侧点击 **Run workflow** 按钮
4. 选择运行模式：
   - `full` — 完整分析（股票 + 大盘复盘）✅ 推荐
   - `stocks-only` — 仅分析自选股，不做大盘复盘
   - `market-only` — 仅做大盘复盘，不分析自选股
5. 点击绿色 **Run workflow** 确认启动

> 启动后通常 1-2 分钟内开始运行，完成后结果推送到 Telegram。

---

## 3. 查看运行状态

### 操作步骤

1. 仓库页面 → 点击顶部 **Actions** 标签
2. 找到 **每日股票分析**，点击最新一条记录
3. 查看状态图标：
   - 🟡 黄色旋转 — 正在运行中
   - ✅ 绿色对勾 — 运行成功，报告已推送
   - ❌ 红色叉号 — 运行失败，需排查日志
   - ⊘ 灰色图标 — 被取消（通常是超时）

### 查看详细日志

点击运行记录 → 点击 **analyze** job → 展开各步骤可查看详细输出日志。

---

## 4. 接收 Telegram 推送

分析完成后，报告会自动发送到你配置的 Telegram Bot。

### 确认配置正确

检查以下 Secrets 是否已在仓库中配置（Settings → Secrets and variables → Actions → Secrets）：

| Secret 名称 | 说明 |
|------------|------|
| `TELEGRAM_BOT_TOKEN` | Telegram Bot 的 Token |
| `TELEGRAM_CHAT_ID` | 接收消息的 Chat ID（你的用户 ID 或群组 ID）|

### 如何获取 Chat ID

1. 在 Telegram 搜索并打开 **@userinfobot**
2. 发送任意消息，Bot 会回复你的 Chat ID
3. 将该 ID 填入 `TELEGRAM_CHAT_ID` Secret

---

## 5. 定时自动运行说明

系统已配置每个工作日自动运行：

| 时区 | 运行时间 |
|------|---------|
| 北京时间（CST） | 每天 **18:00**（周一至周五）|
| UTC 时间 | 每天 **10:00**（周一至周五）|

> 节假日不会自动跳过，如不需要运行可在 Actions 页面手动取消。

---

## 6. 常见问题排查

### ❓ 运行超时（30分钟限制）

**原因**：股票数量过多，或港股 API 响应慢。

**解决方案**：
- 减少 `STOCK_LIST` 中的股票数量（建议 ≤ 15 只）
- 港股股票已做缓存优化，同批次港股只调用一次 API

---

### ❓ 没有收到 Telegram 消息

**排查步骤**：
1. 到 Actions 确认最新运行状态是否为 ✅ 成功
2. 检查 `TELEGRAM_BOT_TOKEN` 和 `TELEGRAM_CHAT_ID` 是否正确配置
3. 确认 Telegram Bot 没有被你屏蔽（先给 Bot 发一条消息激活）
4. 查看 Actions 日志中是否有 "Telegram" 相关报错

---

### ❓ 某只股票数据获取失败

**原因**：数据源 API 偶发限流或网络问题，系统会自动重试 3 次。

**解决方案**：
- 手动重新触发一次运行
- 如持续失败，检查股票代码格式是否正确（参考上方代码格式表）

---

### ❓ 如何修改定时运行时间

编辑 `.github/workflows/daily_analysis.yml` 文件，找到：

```yaml
schedule:
  - cron: '0 10 * * 1-5'  # UTC 10:00 = 北京时间 18:00
```

修改 cron 表达式即可。[Cron 表达式生成工具](https://crontab.guru/)

---

*最后更新：2026-02-24*
